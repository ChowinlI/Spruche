function myAlert(a){$("#alert_content_p").text(a),$("#alert_container").fadeIn(300),$("#alert_div").slideToggle(300)}function closeAlert(){$("#alert-btn").bind("click",function(){$("#alert_container").fadeOut(300),$("#alert_div").slideToggle(300)})}function isMobile(){var a=!!navigator.userAgent.match(/Android/i),b=!!navigator.userAgent.match(/iPhone|iPad|iPod/i),c=!!navigator.userAgent.match(/IEMobile/i),d=!!navigator.userAgent.match(/BlackBerry/i);return!!(a||b||c||d)}function getQueryStringByName(a){var b=location.search.match(new RegExp("[?&]"+a+"=([^&]+)","i"));return null===b||b.length<1?"":b[1]}var alert_flag=!1,timer;!function(a,b){function c(b,c,d){a.ajax({type:"POST",url:b,dataType:"json",traditional:!0,data:{reqData:JSON.stringify(c)},success:function(a){d(a)},error:function(){setTimeout(function(){myAlert("网络繁忙，请稍后再试...")},1e3)}})}b.ajaxEmitter=c}(jQuery,window),function(a){function b(){i=window.innerHeight,k=document.documentElement.scrollTop;for(var a=0;a<l.length;a++)j=l[a].offsetTop-k,j-i<-50&&(l[a].style.left="0");switch(window.location.pathname){case"/":m.attr("data-type","home"),n.attr("data-type","home");break;case"/friendslink":m.attr("data-type","friends"),n.attr("data-type","friends");break;case"/messageboard":m.attr("data-type","tucao"),n.attr("data-type","tucao");break;default:m.attr("data-type","home"),n.attr("data-type","home")}}function c(){l=a(".article-li"),i=window.innerHeight;for(var b=0;b<l.length;b++)k=a(document).scrollTop(),j=l[b].offsetTop-k,j-i<-50&&(l[b].style.left="0")}function d(){a("#mobile-nav").stop((!0).false).animate({left:"0"},200)}function e(){a("#mobile-nav").stop((!0).false).animate({left:"-60%"},200)}function f(a){a.stopPropagation?a.stopPropagation():a.cancelBubble=!0}function g(a,b){var c=new Image;c.src=a,c.complete?b(c.width,c.height):c.onload=function(){b(c.width,c.height)}}function h(b){g(a(".img-view img").attr("src"),function(c,d){var e=a(".img-view").width(),f=a(".img-view").height();if(c/d>e/f){var g=-(d/(c/e))/2*.8;a(".img-view img").css({width:"100%",height:"auto",top:"50%","margin-top":g+"px"})}else c/d===e/f?a(".img-view img").css({width:"100%",height:"100%",top:"0","margin-top":"0"}):a(".img-view img").css({width:"auto",height:"100%",top:"0","margin-top":"0"});b&&a(".img-view").slideDown("slow")})}var i,j,k,l=a(".article-li"),m=a("#nav_ul"),n=a("#mobile_nav_ul"),o=!0,p=1,q=!0,r=!0;b(),a("#container").on("click","#load-more-btn-div-cnt",function(){a("#load-more-btn-div-cnt").css("display","none"),a("#loading-div").css("display","block"),a.ajax({type:"POST",url:"/loadmoreav",dataType:"json",traditional:!0,data:{page:p},success:function(b){if(b.type){var d=b.blogs;p++;var e="";for(var f in d){if(e+='<li class="article-li"><article><div class="article-info-div"><div class="article-user-img-div float-left"><img src="'+d[f].head_img+'"></div><div class="vertical-line-div float-left"><div class="vertical-line"></div></div><div class="article-info float-left"><h3 class="article-title-h"><span class="shine-font-span"></span><a href="/article/av'+d[f].id+'" data-pjax="true">'+d[f].title+'</a></h3><div class="article-other-info"><span><a class="article-author">'+d[f].username+'</a></span><span><a class="article-comments-num" data-count-type="comments" data-pjax="true">'+d[f].commentsView.amount+' Comments</a></span><span><a class="article-view-num">'+d[f].view_num+' Views</a></span><span><a class="article-date">'+new Date(d[f].publish_date).getFullYear()+"-"+(new Date(d[f].publish_date).getMonth()+1)+"-"+new Date(d[f].publish_date).getDate()+'</a></span></div></div><div class="clearfix"></div></div>',""!=d[f].img&&(e+='<div class="article-img-div"><img src="'+d[f].img+'"></div>'),e+='<div class="article-summary-div"><a href="/article/av'+d[f].id+'" data-pjax="true"><p class="article-summary-p">'+d[f].summary.substr(0,155)+"</p></a></div>",""!=d[f].tags){e+='<div class="article-tags-div">';var g=d[f].tags.split(",");for(var h in g)e+="<a>"+g[h]+"</a>";e+="</div>"}e+='<div class="horizontal-line-div"><div class="vertical-line"></div></div></article></li>'}setTimeout(function(){a("#loading-div").css("display","none"),a("#article-ul").append(e),10==d.length&&a("#load-more-btn-div-cnt").css("display","inline-block"),c()},600)}else setTimeout(function(){myAlert("网络繁忙，请稍后再试..."),a("#loading-div").css("display","none"),a("#load-more-btn-div-cnt").css("display","inline-block")},500)},error:function(b,c,d){setTimeout(function(){myAlert("网络繁忙，请稍后再试..."),a("#loading-div").css("display","none"),a("#load-more-btn-div-cnt").css("display","inline-block")},1e3)}})}),closeAlert(),a(window).on("scroll",function(){c(),q&&(a("#head_logo_div").animate({left:"20%"},800,function(){a("#head_nav_div").fadeIn(500)}),a("#head_logo").css({top:"5px",width:"70px",height:"70px","border-width":"2px",transform:"rotate(360deg)"}),a(".motto").fadeOut(800),q=!1),a(document).scrollTop()>=100?a("#backtop").fadeIn(500):a("#backtop").fadeOut(500)}),a("#get-menu-icon").bind("click",function(a){f(a),r&&(d(),r=!1)}),a(document).bind("click",function(){e(),r=!0}),a(document).bind("touchmove",function(){e(),r=!0}),a("#mobile-nav").bind("click",function(a){f(a)}),a("#mobile-nav").bind("touchmove",function(a){f(a)}),a(document).on("click",".article-content-div img",function(){a(".img-view img").attr("src",a(this).attr("src")),a(".img-view h5").text(a(this).attr("alt")),h(!0),o=!1}),a(".img-view").bind("click",function(){a(".img-view").slideUp("slow",function(){a(".img-view img").attr("src","")}),o=!0}),a(window).bind("wheel",function(a){if(r||(a.preventDefault(),e(),r=!0),!o)return a.preventDefault(),!1}),a(document).on("click","#backtop",function(){event.preventDefault(),a("body,html").animate({scrollTop:0},600)}),a(document).on("click",".nav_ul_btn",function(){m.attr("data-type",a(this).attr("data-type")),n.attr("data-type",a(this).attr("data-type"))}),a(document).on("click",".mobile_nav_ul_btn",function(b){f(b),m.attr("data-type",a(this).attr("data-type")),n.attr("data-type",a(this).attr("data-type"))})}(jQuery),function(a){function b(){f.val(""),g.val("")}function c(a){var b=/^(\w|@|#|\$|%|\^|&|\*){6,20}$/;return!!b.exec(a)}function d(a){var b=/^([a-zA-Z0-9]+[_|\_|\.]?)*[a-zA-Z0-9]+@([a-zA-Z0-9]+[_|\_|\.]?)*[a-zA-Z0-9]+\.[a-zA-Z]{2,3}$/;return!!b.test(a)}function e(b){console.log(b.expires);var c=!1;h.is(":checked")&&(c=!0),c?(a.cookie("uid",b.id,{expires:new Date(b.expires),path:"/"}),a.cookie("username",b.username,{expires:new Date(b.expires),path:"/"}),a.cookie("type",b.type,{expires:new Date(b.expires),path:"/"}),a.cookie("token",b.token,{expires:new Date(b.expires),path:"/"})):(a.cookie("uid",b.id,{path:"/"}),a.cookie("username",b.username,{path:"/"}),a.cookie("type",b.type,{path:"/"}),a.cookie("token",b.token,{path:"/"})),window.location.href="/admin#index"}var f=a("#email"),g=a("#password"),h=a("#remember"),i=a("#sure_btn");i.bind("click",function(){if(""==f.val()||""==g.val())return myAlert("请输入用户名和密码"),!1;if(!d(f.val()))return myAlert("邮箱格式不正确"),!1;if(!c(g.val()))return myAlert("密码只能输入6-20个字母、数字、特殊字符"),!1;const i={email:f.val(),password:g.val(),remeber:h.is(":checked")};return a.ajax({type:"POST",url:"/ulogin",dataType:"json",traditional:!0,data:{form:JSON.stringify(i)},success:function(a){switch(a.type){case 0:e(a.user);break;case 1:myAlert("用户名或密码错误"),b();break;case 2:myAlert("你是机器人吗？"),b()}},error:function(a,b,c){myAlert("网络繁忙，请稍后再试...")}}),!1}),closeAlert()}(jQuery),$(document).pjax('a[data-pjax="true"]',"#container",{fragment:"#container",timeout:8e3}),$(document).on("pjax:beforeSend",function(){$("#progress-bar").animate({width:"20%"})}),$(document).on("pjax:send",function(){$("#progress-bar").animate({width:"40%"})}),$(document).on("pjax:complete",function(){$("#progress-bar").animate({width:"80%"})}),$(document).on("pjax:end",function(){$("#progress-bar").animate({width:"100%"},function(){$("#progress-bar").css({width:"0"})}),SyntaxHighlighter.highlight(),$("table.syntaxhighlighter").each(function(){if(!$(this).hasClass("nogutter")){var a=$($(this).find(".gutter")[0]),b=$($(this).find(".code .line"));a.find(".line").each(function(a){$(this).height($(b[a]).height()),$(b[a]).height($(b[a]).height())})}})}),function(a){function b(a){var b=/^(\w|@|#|\$|%|\^|&|\*){6,20}$/;return!!b.exec(a)}function c(a){var b=/^([a-zA-Z0-9]+[_|\_|\.]?)*[a-zA-Z0-9]+@([a-zA-Z0-9]+[_|\_|\.]?)*[a-zA-Z0-9]+\.[a-zA-Z]{2,3}$/;return!!b.test(a)}var d=a("#start-website"),e=a("#start-username"),f=a("#start-email"),g=a("#start-password"),h=a("#start-rpassword"),i=a("#start_sure_btn"),j=location.protocol+"//"+location.hostname;i.bind("click",function(){return""==d.val()||""==e.val()||""==f.val()||""==g.val()||""==h.val()?(myAlert("信息不能为空"),!1):b(g.val())?c(f.val())?g.val()==h.val()?(a.ajax({type:"POST",url:"/start",dataType:"json",traditional:!0,data:{website:d.val(),username:e.val(),email:f.val(),password:g.val(),domain:j},success:function(a){a&&(window.location.href="/login")},error:function(a,b,c){myAlert("网络繁忙，请稍后再试...")}}),!1):(myAlert("两次密码不一样"),!1):(myAlert("请输入正确的邮箱"),!1):(myAlert("密码只能输入6-20个字母、数字、特殊字符"),!1)}),closeAlert()}(jQuery),function(a){function b(b){for(var d="",e=b.length-1;e>=0;e--)d+="<a>"+b[e].tags_name+"</a>";a("#tags").html(d),c()}function c(){try{var b,c=document.getElementById("tags").childNodes;for(b in c)"A"==c[b].nodeName&&c[b].addEventListener("click",function(a){a.preventDefault()});a("#tag_canvas").attr("width",a(window).width()),a("#tag_canvas").attr("height",a(window).height()),TagCanvas.Start("tag_canvas","tags",{textColour:"#a7a7a7",outlineColour:"#ffffff",reverse:!0,textHeight:15,bgOutlineThickness:0,depth:.5,dragControl:!1,decel:.75,dragThreshold:10,fadeIn:3e3,maxSpeed:.05,initial:[-.1,.1],maxBrightness:.8,maxSpeed:.03,noSelect:!0,wheelZoom:!1})}catch(a){}}a(document).ready(function(){isMobile()?a("#tags-canvas-content").css("display","none"):a.ajax({type:"POST",url:"/tags",dataType:"json",traditional:!0,data:{},success:function(a){a.type&&b(a.tags)},error:function(a,b,c){}})}),a(window).resize(function(){a("#tag_canvas").attr("width",a(window).width()),a("#tag_canvas").attr("height",a(window).height())})}(jQuery);